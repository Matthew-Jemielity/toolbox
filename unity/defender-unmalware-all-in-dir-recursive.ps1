# Windows devs in their wisdom did not think about allowing the user to select a directory
# to recursively allow all executables within through the malware blocker.
# Since using IDEs such as Unity with malware blocker enabled is a NIGHTMARE otherwise,
# this PowerShell script attempts to mitigate that lack of basic functionality.
# Obviously spaces in filenames will cause problems,
# a bug worked around since times immemorial, surely.

$path = $args[0]
$executables = Get-ChildItem -Filter "*.exe" -Recurse -Name $path  | % { $path + "\" + $_ }

For ($i=0; $i -lt $executables.Length; $i++) {
	Add-MpPreference -ControlledFolderAccessAllowedApplications $executables[$i]
}

